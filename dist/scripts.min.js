"use strict";function setActiveLink(e){e.preventDefault(),Array.from(links,function(e){return e.classList.remove("menu__link--active")});var t=e.target;if(!t.classList.contains("menu__link"))return!1;t.classList.add("menu__link--active"),activeLink.node=pages[arrLinks.indexOf(t.textContent)],activeLink.node.classList.add("js-block"),wayfull.classList.remove("js-block")}function getWeather(e,t,r){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=function(e){var t=n(e);this.weekday=t.toLocaleString(r,{weekday:"long"}),this.date=t.toLocaleString(r,{day:"2-digit",month:"long",year:"numeric"})},t=function(e,t,r,n,a){this.title=e,this.icon=t,this.precipType=r,this.temperature=n>0?"+"+Math.round(n):Math.round(n),this.description=a},n=function(e){return new Date(1e3*e)},a=JSON.parse(this.responseText);weather.now.icon=a.currently.icon,weather.now.description=a.currently.summary,a.currently.temperature>0?weather.now.temperature="+"+Math.round(a.currently.temperature):weather.now.temperature=Math.round(a.currently.temperature);var o=24-n(a.hourly.data[0].time).getHours();weather.today.header=new e(a.hourly.data[0].time);a.hourly.data.slice(0,o).forEach(function(e,a){return weather.today.body[a]=new t(n(e.time).toLocaleString(r,{hour:"2-digit",minute:"2-digit"}),e.icon,e.precipType,Math.round(e.temperature),e.summary)}),weather.tomorrow.header=new e(a.hourly.data[o].time);var i=a.hourly.data.slice(o,o+25),d=i[2],l=i[8],u=i[14],c=i[20],s=[d,l,u,c],m=["Ночь","Утро","День","Вечер"];s.forEach(function(e,r){return weather.tomorrow.body[r]=new t(m[r],e.icon,e.precipType,Math.round(e.temperature),e.summary)});var y=n(a.hourly.data[0].time).getDay(),p=void 0;y<6?p=5-y:6===y&&(p=6);var h=void 0;y<6?h=6-y:6===y&&(h=0,sundayHide());var w=o+24*p,v=o+24*h;weather.weekend.saturday.header=new e(a.hourly.data[w].time),weather.weekend.sunday.header=new e(a.hourly.data[v].time);var L=void 0;L=6!==p?a.hourly.data.slice(w,w+24):a.hourly.data.slice(w-o,w-o+24);[L[2],L[8],L[14],L[20]].forEach(function(e,r){return weather.weekend.saturday.body[r]=new t(m[r],e.icon,e.precipType,Math.round(e.temperature),e.summary)});var T=a.hourly.data.slice(v,v+24);[T[2],T[8],T[14],T[20]].forEach(function(e,r){return weather.weekend.sunday.body[r]=new t(m[r],e.icon,e.precipType,Math.round(e.temperature),e.summary)}),console.log(weather),console.log(a),headerTemplate(),todayHeaderTemplate(),todayTemplate(),tomorrowHeaderTemplate(),tomorrowTemplate(),saturdayHeaderTemplate(),saturdayTemplate(),sundayHeaderTemplate(),sundayTemplate()}};var a="https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/606d16650a24656a795100b26c1b1a3e/"+e+","+t+"?extend=hourly&lang=ru&units=si";n.open("GET",a,!0),n.send()}function headerTemplate(){var e=document.getElementById("header-template").innerHTML,t=Handlebars.compile(e),r=t(weather.now),n=document.querySelector(".header-visual__js-block"),a=document.querySelector(".header-visual__js-templ");""!==n.innerHTML?(a.remove(),n.innerHTML+=r):n.innerHTML+=r}function todayTemplate(){var e=document.getElementById("today-template").innerHTML,t=Handlebars.compile(e),r=t(weather.today.body),n=document.querySelector(".today__main"),a=document.querySelector(".today__block");""!==n.innerHTML?(a.remove(),n.innerHTML+=r):n.innerHTML+=r}function todayHeaderTemplate(){var e=document.getElementById("today-header-template").innerHTML,t=Handlebars.compile(e),r=t(weather.today.header),n=document.querySelector(".today__title"),a=document.querySelector(".today__header-block");""!==n.innerHTML?(a.remove(),n.innerHTML+=r):n.innerHTML+=r}function tomorrowTemplate(){var e=document.getElementById("tomorrow-template").innerHTML,t=Handlebars.compile(e),r=t(weather.tomorrow.body),n=document.querySelector(".tomorrow__main"),a=document.querySelector(".tomorrow__block");""!==n.innerHTML?(a.remove(),n.innerHTML+=r):n.innerHTML+=r}function tomorrowHeaderTemplate(){var e=document.getElementById("tomorrow-header-template").innerHTML,t=Handlebars.compile(e),r=t(weather.tomorrow.header),n=document.querySelector(".tomorrow__title"),a=document.querySelector(".tomorrow__header-block");""!==n.innerHTML?(a.remove(),n.innerHTML+=r):n.innerHTML+=r}function saturdayHeaderTemplate(){var e=document.getElementById("saturday-header-template").innerHTML,t=Handlebars.compile(e),r=t(weather.weekend.saturday.header),n=document.querySelector(".js-saturday__title"),a=document.querySelector(".saturday__header-block");""!==n.innerHTML?(a.remove(),n.innerHTML+=r):n.innerHTML+=r}function saturdayTemplate(){var e=document.getElementById("saturday-template").innerHTML,t=Handlebars.compile(e),r=t(weather.weekend.saturday.body),n=document.querySelector(".saturday__main"),a=document.querySelector(".saturday__block");""!==n.innerHTML?(a.remove(),n.innerHTML+=r):n.innerHTML+=r}function sundayHeaderTemplate(){var e=document.getElementById("sunday-header-template").innerHTML,t=Handlebars.compile(e),r=t(weather.weekend.sunday.header),n=document.querySelector(".js-sunday__title"),a=document.querySelector(".sunday__header-block");""!==n.innerHTML?(a.remove(),n.innerHTML+=r):n.innerHTML+=r}function sundayTemplate(){var e=document.getElementById("sunday-template").innerHTML,t=Handlebars.compile(e),r=t(weather.weekend.sunday.body),n=document.querySelector(".sunday__main"),a=document.querySelector(".sunday__block");""!==n.innerHTML?(a.remove(),n.innerHTML+=r):n.innerHTML+=r}function sundayHide(){document.querySelector(".js-sunday").classList.add("js-sunday--none")}Array.from||(Array.from=function(){var e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},r=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t},n=Math.pow(2,53)-1,a=function(e){var t=r(e);return Math.min(Math.max(t,0),n)};return function(e){var r=this,n=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var o,i=arguments.length>1?arguments[1]:void 0;if(void 0!==i){if(!t(i))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(o=arguments[2])}for(var d,l=a(n.length),u=t(r)?Object(new r(l)):new Array(l),c=0;c<l;)d=n[c],u[c]=i?void 0===o?i(d,c):i.call(o,d,c):d,c+=1;return u.length=l,u}}());var controls=document.querySelector(".page__menu"),links=controls.querySelectorAll(".menu__link"),addSity=document.querySelector(".add-sity"),wayfull=document.querySelector(".wayfull"),lookWay=document.querySelector(".add-sity__look"),pages=document.querySelectorAll(".js-page"),arrLinks=[links[0].textContent,links[1].textContent,links[2].textContent,links[3].textContent],activeLink={node:pages[0]},removeActiveLink=function(e){e.preventDefault(),activeLink.node.classList.remove("js-block")},activeWayFullLink=function(e){e.preventDefault(),addSity.classList.remove("js-block"),wayfull.classList.add("js-block")};controls.addEventListener("click",removeActiveLink),controls.addEventListener("click",setActiveLink),lookWay.addEventListener("click",activeWayFullLink);var inputCity=document.getElementById("search-city"),autocomplete=new google.maps.places.Autocomplete(inputCity,{types:["(cities)"]}),positions={latPositions:"",lngPositions:""};google.maps.event.addListener(autocomplete,"place_changed",function(){var e=autocomplete.getPlace();console.log(e),document.getElementById("header-visual__city").textContent=e.name,positions.latPositions=e.geometry.location.lat(),positions.lngPositions=e.geometry.location.lng(),getWeather(positions.latPositions,positions.lngPositions,"ru")});var weather={now:{icon:"",temperature:"",description:""},today:{header:{},body:[]},tomorrow:{header:{},body:[]},weekend:{saturday:{header:{},body:[]},sunday:{header:{},body:[]}}};getWeather(50.4501,30.523400000000038,"ru");